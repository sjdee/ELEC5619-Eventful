$(document).ready(function() {
	
	var filePath = "";
	
	$('#singleUploadForm').submit(function(event) {
	    var formElement = this;
	    // You can directly create form data from the form element
	    // (Or you could get the files from input element and append them to FormData as we did in vanilla javascript)
	    var formData = new FormData(formElement);
	    
	    $.ajax({
	        type: "POST",
	        enctype: 'multipart/form-data',
	        url: "/uploadFile",
	        data: formData,
	        processData: false,
	        contentType: false,
	        success: function (response) {
	            console.log(response);
	            filePath = response.fileDownloadUri;
	            document.getElementById('uploaded-image').setAttribute("src", filePath); 
	            window.alert("Image uploaded successfully!");
	        },
	        error: function (error) {
	            console.log(error);
	            // process error
	        }
	    });

	    event.preventDefault();
	});
	
	$('#create-post').submit(function(event) {
									
		$(this).append('<input type="hidden" name="filePath" value="' + filePath + '">');
	    
	});

    // File Input Path
    $(document).on('change', '.file-field input[type="file"]', function () {
    	
    	$('#singleUploadForm').submit();
    });
   
	$('#singleUploadForm').submit(function(event) {
	    var formElement = this;
	    // You can directly create form data from the form element
	    // (Or you could get the files from input element and append them to FormData as we did in vanilla javascript)
	    var formData = new FormData(formElement);
	    
	    $.ajax({
	        type: "POST",
	        enctype: 'multipart/form-data',
	        url: "/uploadFile",
	        data: formData,
	        processData: false,
	        contentType: false,
	        success: function (response) {
	            filePath = response.fileDownloadUri;
	            
	            window.alert("Image uploaded successfully!");
	        },
	        error: function (error) {
	            console.log(error);
	            // process error
	        }
	    });

	    event.preventDefault();
	});
    
});

function likePost(postId) {
  window.alert("liked " + postId);
  
  document.getElementById("post-likes-" + postId).innerHTML = 2;
    
  var postLike = {}
  postLike["postId"] = postId;
  
  $.ajax({
      type: "POST",
      contentType: "application/json",
      url: "/api/search",
      data: JSON.stringify(search),
      dataType: 'json',
      cache: false,
      timeout: 600000,
      success: function (data) {

          var json = "<h4>Ajax Response</h4><pre>"
              + JSON.stringify(data, null, 4) + "</pre>";
          $('#feedback').html(json);

          console.log("SUCCESS : ", data);
          $("#btn-search").prop("disabled", false);

      },
      error: function (e) {

          var json = "<h4>Ajax Response</h4><pre>"
              + e.responseText + "</pre>";
          $('#feedback').html(json);

          console.log("ERROR : ", e);
          $("#btn-search").prop("disabled", false);

      }
  });
  
}